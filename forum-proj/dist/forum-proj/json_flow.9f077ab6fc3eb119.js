"use strict";(self.webpackChunkforum_proj=self.webpackChunkforum_proj||[]).push([[402],{9325:(pn,wt,Y)=>{Y.d(wt,{Chord:()=>le,ChordDirected:()=>Ce,ChordLink:()=>he,ChordLinkDirected:()=>xe,ChordNodes:()=>we,ChordNonRibbon:()=>je,Flow:()=>ne,FlowLink:()=>oe,FlowNode:()=>ve,FlowNodes:()=>se,Sankey:()=>Ge,SankeyLink:()=>Ae,SankeyNodes:()=>_e});var De=Y(655),xt=Y(2056),K=Y(1872),_t=Y(4005),Ie=Y(8707),V=Y(9660);class At extends xt.Q{setupDefaultRules(){super.setupDefaultRules();const t=this._root.interfaceColors,e=this.rule.bind(this);e("Flow").setAll({width:K.AQ,height:K.AQ,paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10}),e("FlowNodes").setAll({colors:_t.U.new(this._root,{}),legendLabelText:"{name}",legendValueText:"{sumOutgoing.formatNumber('#.#')}"}),e("FlowNode").setAll({}),e("FlowNode",["unknown"]).setAll({draggable:!1,opacity:0}),e("RadialLabel",["flow","node"]).setAll({text:"{name}",populateText:!0}),e("FlowLink").setAll({fillStyle:"gradient",strokeStyle:"gradient"}),e("FlowLink",["source","unknown"]).setAll({}),e("FlowLink",["target","unknown"]).setAll({}),e("FlowNode").events.on("pointerover",i=>{const a=i.target.dataItem;if(a){const o=a.get("outgoingLinks");o&&V.S6(o,u=>{const b=u.get("link");b.hover(),b.hideTooltip()});const l=a.get("incomingLinks");l&&V.S6(l,u=>{const b=u.get("link");b.hover(),b.hideTooltip()})}let s=a.get("slice")||a.get("rectangle");s&&s.get("tooltipText")&&s.showTooltip()}),e("FlowNode").events.on("pointerout",i=>{const a=i.target.dataItem;if(a){const s=a.get("outgoingLinks");s&&V.S6(s,l=>{l.get("link").unhover()});const o=a.get("incomingLinks");o&&V.S6(o,l=>{l.get("link").unhover()})}}),e("Sankey").setAll({orientation:"horizontal",nodeAlign:"justify",linkTension:.5,nodePadding:10,nodeWidth:10}),e("RoundedRectangle",["sankey","node","shape"]).setAll({cornerRadiusTL:0,cornerRadiusBL:0,cornerRadiusTR:0,cornerRadiusBR:0}),e("SankeyLink").setAll({controlPointDistance:.2}),e("FlowNode",["sankey"]).setAll({draggable:!0});{const i=e("Graphics",["sankey","link"]);i.setAll({fillOpacity:.2,strokeOpacity:0,interactive:!0,tooltipText:"{sourceId} - {targetId}: {value}"}),(0,Ie.v)(i,"fill",t,"grid")}e("Graphics",["sankey","link"]).states.create("hover",{fillOpacity:.5}),e("Label",["sankey","node"]).setAll({text:"{name}",populateText:!0}),e("Label",["sankey","horizontal"]).setAll({y:K.CI,centerY:K.CI,paddingLeft:15}),e("Label",["sankey","vertical"]).setAll({x:K.CI,centerX:K.CI,paddingTop:15}),e("Chord").setAll({radius:(0,K.aQ)(90),nodeWidth:10,padAngle:1,startAngle:0,sort:"descending"}),e("ChordDirected").setAll({linkHeadRadius:10}),e("ChordNodes").setAll({x:K.CI,y:K.CI}),e("FlowNode",["chord"]).setAll({draggable:!0}),e("ChordLink").setAll({sourceRadius:K.AQ,targetRadius:K.AQ,fillStyle:"solid",strokeStyle:"solid",tooltipText:"{sourceId} - {targetId}: {value}"}),e("Slice",["chord","node","shape"]).setAll({cornerRadius:0}),e("RadialLabel",["chord","node"]).setAll({radius:5,textType:"circular"}),e("ChordLinkDirected").setAll({headRadius:10});{const i=e("Graphics",["chord","link","shape"]);i.setAll({fillOpacity:.2,strokeOpacity:0,interactive:!0}),(0,Ie.v)(i,"fill",t,"grid"),(0,Ie.v)(i,"stroke",t,"grid")}e("Graphics",["chord","link","shape"]).states.create("hover",{fillOpacity:.5}),e("ChordNonRibbon").setAll({linkType:"curve"}),e("ChordLink",["basic"]).setAll({fillStyle:"none",strokeStyle:"source"}),e("Graphics",["chord","link","shape","basic"]).setAll({strokeOpacity:.4}),e("Graphics",["chord","link","shape","basic"]).states.create("hover",{strokeWidth:2,strokeOpacity:1})}}var Se=Y(6433),Re=Y(7970),Ke=Y(8478),te=Y(8256);class ne extends Se.F{constructor(){super(...arguments),Object.defineProperty(this,"linksContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(Re.W.new(this._root,{}))}),Object.defineProperty(this,"_nodesData",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_linksData",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_index",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_nodesDataSet",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_linksByIndex",{enumerable:!0,configurable:!0,writable:!0,value:{}})}_afterNew(){this._defaultThemes.push(At.new(this._root)),this.fields.push("disabled","sourceId","targetId"),this.nodes&&(this.nodes.flow=this),super._afterNew(),this.children.push(this.bulletsContainer)}processDataItem(t){super.processDataItem(t);const e=this.nodes;if(e){let i=!1,a=t.get("sourceId"),s=e.getDataItemById(a);s||(null==a&&(a="undefined"+this._index,this._index++,i=!0),e.data.push({id:a,unknown:i}),s=e.getDataItemById(a),i||s.set("name",a)),i=!1;let o=t.get("targetId"),l=e.getDataItemById(o);l||(null==o&&(o="undefined"+this._index,this._index++,i=!0),e.data.push({id:o,unknown:i}),l=e.getDataItemById(o),i||l.set("name",o)),s&&(t.set("source",s),e.addOutgoingLink(s,t)),l&&(t.set("target",l),e.addincomingLink(l,t)),t.set("link",this.makeLink(t));const u=this.nodes.dataItems.indexOf(s),b=this.nodes.dataItems.indexOf(l);this._linksByIndex[u+"_"+b]=t,s.get("unknown")&&(l&&s.set("fill",l.get("fill")),t.get("link").set("fillStyle","gradient")),l.get("unknown")&&(s&&l.set("fill",s.get("fill")),t.get("link").set("fillStyle","gradient")),this._updateLinkColor(t)}}_onDataClear(){this.nodes._userDataSet||(this.nodes.data.setAll([]),this.nodes._userDataSet=!1)}_prepareChildren(){super._prepareChildren();let t=1/0,e=-1/0,i=0;if(this._valuesDirty){this._nodesData=[];const a=this.nodes;a&&V.S6(a.dataItems,s=>{const o=s.get("d3SankeyNode");this._nodesData.push(o);const l=s.get("incomingLinks");let u=0,b=0;l&&V.S6(l,N=>{const L=N.get("value"),P=N.get("valueWorking");u+=L,b+=P}),s.set("sumIncoming",u),s.set("sumIncomingWorking",b);const k=s.get("outgoingLinks");let A=0,S=0;k&&V.S6(k,N=>{const L=N.get("value"),P=N.get("valueWorking");A+=L,S+=P}),s.set("sumOutgoing",A),s.set("sumOutgoingWorking",S),s.set("sum",u+A),s.set("sumWorking",b+S),a.updateLegendValue(s)}),this._linksData=[],V.S6(this.dataItems,s=>{let o=s.get("value");te.hj(o)&&(o<t&&(t=o),o>e&&(e=o),i+=o)}),V.S6(this.dataItems,s=>{let o=s.get("value");if(te.hj(o)){let l=s.get("valueWorking"),u=this.get("minSize",0);u>0&&l<u*i&&(l=u*i);let b={source:s.get("source").get("d3SankeyNode"),target:s.get("target").get("d3SankeyNode"),value:l};s.setRaw("d3SankeyLink",b),this._linksData.push(b),this.updateLegendValue(s)}}),this.setPrivateRaw("valueHigh",e),this.setPrivateRaw("valueLow",t),this.setPrivateRaw("valueSum",i)}}_updateLinkColor(t){const e=t.get("link"),i=e.get("fillStyle"),a=e.get("strokeStyle"),s=t.get("source"),o=t.get("target"),l=s.get("fill"),u=o.get("fill");switch(e.remove("fillGradient"),e.remove("strokeGradient"),i){case"solid":e._applyTemplates();break;case"source":e.set("fill",l);break;case"target":e.set("fill",u);break;case"gradient":let b=e._fillGradient;if(!b){b=Ke.o.new(this._root,{});const k={color:l};s.get("unknown")&&(k.opacity=0);const A={color:u};o.get("unknown")&&(A.opacity=0),b.set("stops",[k,A]),e._fillGradient=b}e.set("fillGradient",b);break;case"none":e.set("fill",void 0)}switch(a){case"solid":e._applyTemplates();break;case"source":e.set("stroke",l);break;case"target":e.set("stroke",u);case"gradient":let b=e._strokeGradient;if(!b){b=Ke.o.new(this._root,{});const k={color:l};s.get("unknown")&&(k.opacity=0);const A={color:u};o.get("unknown")&&(A.opacity=0),b.set("stops",[k,A]),e._strokeGradient=b}e.set("strokeGradient",b);break;case"none":e.remove("stroke")}}disposeDataItem(t){super.disposeDataItem(t);let e=t.get("link");e&&(this.links.removeValue(e),e.dispose())}hideDataItem(t,e){const i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return(0,De.mG)(this,void 0,void 0,function*(){const a=[i.hideDataItem.call(this,t,e)],s=this.states.create("hidden",{}),o="stateAnimationDuration",l="stateAnimationEasing";te.hj(e)||(e=s.get(o,this.get(o,0)));const u=s.get(l,this.get(l));a.push(t.animate({key:"valueWorking",to:0,duration:e,easing:u}).waitForStop()),t.get("link").hide(),yield Promise.all(a)})}showDataItem(t,e){const i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return(0,De.mG)(this,void 0,void 0,function*(){const a=[i.showDataItem.call(this,t,e)];te.hj(e)||(e=this.get("stateAnimationDuration",0));const s=this.get("stateAnimationEasing");a.push(t.animate({key:"valueWorking",to:t.get("value"),duration:e,easing:s}).waitForStop()),t.get("link").show(),yield Promise.all(a)})}_positionBullet(t){const e=t.get("sprite");if(e){const i=e.dataItem;if(i){const a=i.get("link"),s=t.get("sprite");if(s){const o=a.getPoint(this._getBulletLocation(t));s.setAll({x:o.x,y:o.y}),t.get("autoRotate")&&s.set("rotation",o.angle+t.get("autoRotateAngle",0))}}}}_getBulletLocation(t){return t.get("locationY",0)}}Object.defineProperty(ne,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Flow"}),Object.defineProperty(ne,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Se.F.classNames.concat([ne.className])});var Qe=Math.abs,de=Math.cos,pe=Math.sin,Ze=Math.PI,Te=Ze/2,Ue=2*Ze,Je=Math.max,Fe=1e-12;function Ee(n,t){return Array.from({length:t-n},(e,i)=>n+i)}function Ye(n,t){var e=0,i=null,a=null,s=null;function o(l){var L,u=l.length,b=new Array(u),k=Ee(0,u),A=new Array(u*u),S=new Array(u),N=0;l=Float64Array.from({length:u*u},t?(P,f)=>l[f%u][f/u|0]:(P,f)=>l[f/u|0][f%u]);for(let P=0;P<u;++P){let f=0;for(let p=0;p<u;++p)f+=l[P*u+p]+n*l[p*u+P];N+=b[P]=f}L=(N=Je(0,Ue-e*u)/N)?e:Ue/u;{let P=0;i&&k.sort((f,p)=>i(b[f],b[p]));for(const f of k){const p=P;if(n){const _=Ee(1+~u,u).filter(m=>m<0?l[~m*u+f]:l[f*u+m]);a&&_.sort((m,w)=>a(m<0?-l[~m*u+f]:l[f*u+m],w<0?-l[~w*u+f]:l[f*u+w]));for(const m of _)m<0?(A[~m*u+f]||(A[~m*u+f]={source:null,target:null})).target={index:f,startAngle:P,endAngle:P+=l[~m*u+f]*N,value:l[~m*u+f]}:(A[f*u+m]||(A[f*u+m]={source:null,target:null})).source={index:f,startAngle:P,endAngle:P+=l[f*u+m]*N,value:l[f*u+m]};S[f]={index:f,startAngle:p,endAngle:P,value:b[f]}}else{const _=Ee(0,u).filter(m=>l[f*u+m]||l[m*u+f]);a&&_.sort((m,w)=>a(l[f*u+m],l[f*u+w]));for(const m of _){let w;if(f<m?(w=A[f*u+m]||(A[f*u+m]={source:null,target:null}),w.source={index:f,startAngle:P,endAngle:P+=l[f*u+m]*N,value:l[f*u+m]}):(w=A[m*u+f]||(A[m*u+f]={source:null,target:null}),w.target={index:f,startAngle:P,endAngle:P+=l[f*u+m]*N,value:l[f*u+m]},f===m&&(w.source=w.target)),w.source&&w.target&&w.source.value<w.target.value){const O=w.source;w.source=w.target,w.target=O}}S[f]={index:f,startAngle:p,endAngle:P,value:b[f]}}P+=L}}return(A=Object.values(A)).groups=S,s?A.sort(s):A}return o.padAngle=function(l){return arguments.length?(e=Je(0,l),o):e},o.sortGroups=function(l){return arguments.length?(i=l,o):i},o.sortSubgroups=function(l){return arguments.length?(a=l,o):a},o.sortChords=function(l){return arguments.length?(null==l?s=null:(s=function Lt(n){return function(t,e){return n(t.source.value+t.target.value,e.source.value+e.target.value)}}(l))._=l,o):s&&s._},o}var St=Y(1115),Tt=Array.prototype.slice;function ce(n){return function(){return n}}function Pt(n){return n.source}function Ot(n){return n.target}function qe(n){return n.radius}function Ct(n){return n.startAngle}function jt(n){return n.endAngle}function zt(){return 0}function Mt(){return 10}function et(n){var t=Pt,e=Ot,i=qe,a=qe,s=Ct,o=jt,l=zt,u=null;function b(){var k,A=t.apply(this,arguments),S=e.apply(this,arguments),N=l.apply(this,arguments)/2,L=Tt.call(arguments),P=+i.apply(this,(L[0]=A,L)),f=s.apply(this,L)-Te,p=o.apply(this,L)-Te,_=+a.apply(this,(L[0]=S,L)),m=s.apply(this,L)-Te,w=o.apply(this,L)-Te;if(u||(u=k=(0,St.ET)()),N>Fe&&(Qe(p-f)>2*N+Fe?p>f?(f+=N,p-=N):(f-=N,p+=N):f=p=(f+p)/2,Qe(w-m)>2*N+Fe?w>m?(m+=N,w-=N):(m-=N,w+=N):m=w=(m+w)/2),u.moveTo(P*de(f),P*pe(f)),u.arc(0,0,P,f,p),f!==m||p!==w)if(n){var j=_-+n.apply(this,arguments),H=(m+w)/2;u.quadraticCurveTo(0,0,j*de(m),j*pe(m)),u.lineTo(_*de(H),_*pe(H)),u.lineTo(j*de(w),j*pe(w))}else u.quadraticCurveTo(0,0,_*de(m),_*pe(m)),u.arc(0,0,_,m,w);if(u.quadraticCurveTo(0,0,P*de(f),P*pe(f)),u.closePath(),k)return u=null,k+""||null}return n&&(b.headRadius=function(k){return arguments.length?(n="function"==typeof k?k:ce(+k),b):n}),b.radius=function(k){return arguments.length?(i=a="function"==typeof k?k:ce(+k),b):i},b.sourceRadius=function(k){return arguments.length?(i="function"==typeof k?k:ce(+k),b):i},b.targetRadius=function(k){return arguments.length?(a="function"==typeof k?k:ce(+k),b):a},b.startAngle=function(k){return arguments.length?(s="function"==typeof k?k:ce(+k),b):s},b.endAngle=function(k){return arguments.length?(o="function"==typeof k?k:ce(+k),b):o},b.padAngle=function(k){return arguments.length?(l="function"==typeof k?k:ce(+k),b):l},b.source=function(k){return arguments.length?(t=k,b):t},b.target=function(k){return arguments.length?(e=k,b):e},b.context=function(k){return arguments.length?(u=k??null,b):u},b}function tt(){return et()}function nt(){return et(Mt)}function Gt(n,t){return null==n||null==t?NaN:n<t?-1:n>t?1:n>=t?0:NaN}function It(n,t){return null==n||null==t?NaN:t<n?-1:t>n?1:t>=n?0:NaN}Y(693);Math;function ke(n){return{type:n}}function be(n,t,e){this.k=n,this.x=t,this.y=e}["w","e"].map(ke),["n","s"].map(ke),["n","w","e","s","nw","ne","sw","se"].map(ke),be.prototype={constructor:be,scale:function(n){return 1===n?this:new be(this.k*n,this.x,this.y)},translate:function(n,t){return 0===n&0===t?this:new be(this.k,this.x+this.k*n,this.y+this.k*t)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new be(1,0,0);var ie=Y(5344),re=Y(7379),Jt=Y(1705);class ve extends Re.W{constructor(){super(...arguments),Object.defineProperty(this,"series",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}}Object.defineProperty(ve,"className",{enumerable:!0,configurable:!0,writable:!0,value:"FlowNode"}),Object.defineProperty(ve,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Re.W.classNames.concat([ve.className])});class se extends Se.F{constructor(){super(...arguments),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:new re.o(ie.YS.new({}),()=>Jt._._new(this._root,{},[this.labels.template]))}),Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:new re.o(ie.YS.new({}),()=>ve._new(this._root,{themeTags:["node"]},[this.nodes.template]))}),Object.defineProperty(this,"_userDataSet",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_afterNew(){this.fields.push("unknown","name","fill"),this.set("idField","id"),this.set("nameField","id"),this.set("fillField","fill"),this.set("unknownField","unknown"),this.children.push(this.bulletsContainer),super._afterNew()}_onDataClear(){const t=this.get("colors");t&&t.reset(),this._userDataSet=!0}processDataItem(t){if(super.processDataItem(t),t.setRaw("d3SankeyNode",{name:t.get("id"),dataItem:t}),null==t.get("fill")){let e=this.get("colors");e&&t.setRaw("fill",e.next())}t.setRaw("node",this.makeNode(t))}makeNode(t,e){const i=this.nodes.make();return this.nodes.push(i),e&&i.addTag(e),t.get("unknown")&&i.addTag("unknown"),this.children.push(i),i._setDataItem(t),i.series=this,t.set("node",i),i}disposeDataItem(t){super.disposeDataItem(t);let e=t.get("node");e&&(this.nodes.removeValue(e),e.dispose());let i=t.get("label");i&&(this.labels.removeValue(i),i.dispose())}addincomingLink(t,e){let i=t.get("incomingLinks");i||(i=[],t.set("incomingLinks",i)),i.push(e)}addOutgoingLink(t,e){let i=t.get("outgoingLinks");i||(i=[],t.set("outgoingLinks",i)),i.push(e)}showDataItem(t,e){const i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return(0,De.mG)(this,void 0,void 0,function*(){const a=[i.showDataItem.call(this,t,e)],s=this.flow;if(s){let o=t.get("label");o&&o.show(e);let l=t.get("outgoingLinks");l&&V.S6(l,u=>{s.showDataItem(u,e)}),l=t.get("incomingLinks"),l&&V.S6(l,u=>{s.showDataItem(u,e)})}yield a})}hideDataItem(t,e){const i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return(0,De.mG)(this,void 0,void 0,function*(){const a=[i.hideDataItem.call(this,t,e)],s=this.flow;if(s){let o=t.get("label");o&&o.hide(e);let l=t.get("outgoingLinks");l&&V.S6(l,u=>{s.hideDataItem(u,e)}),l=t.get("incomingLinks"),l&&V.S6(l,u=>{s.hideDataItem(u,e)})}yield a})}}Object.defineProperty(se,"className",{enumerable:!0,configurable:!0,writable:!0,value:"FlowNodes"}),Object.defineProperty(se,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Se.F.classNames.concat([se.className])});var qt=Y(3792),en=Y(5129),T=Y(5106);class we extends se{constructor(){super(...arguments),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:new re.o(ie.YS.new({}),()=>en.x._new(this._root,{},[this.labels.template]))}),Object.defineProperty(this,"flow",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dAngle",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"rectangles",{enumerable:!0,configurable:!0,writable:!0,value:new re.o(ie.YS.new({}),()=>qt.p._new(this._root,{themeTags:["shape"]},[this.rectangles.template]))})}makeNode(t){const e=super.makeNode(t,"chord"),i=e.children.insertIndex(0,this.rectangles.make());t.set("slice",i),i._setSoft("fill",t.get("fill"));const a=this.labels.make();return this.labels.push(a),a.addTag("flow"),a.addTag("chord"),a.addTag("node"),e.children.push(a),t.set("label",a),e.events.on("dragstart",s=>{let o=this.toLocal(s.point);const l=T._O({x:0,y:0},o);this.flow&&(this._dAngle=this.flow.get("startAngle",0)-l)}),e.events.on("dragged",s=>{let o=this.toLocal(s.point);const l=T._O({x:0,y:0},o);e.setAll({x:0,y:0}),this.flow&&this.flow.set("startAngle",l+this._dAngle)}),a._setDataItem(t),i._setDataItem(t),e}_positionBullet(t){const e=t.get("sprite");if(e){const i=e.dataItem;if(i){const a=t.get("sprite");if(a){const s=i.get("slice"),o=t.get("locationX",.5),l=t.get("locationY",.5);if(s){const u=s.get("radius",0),b=s.get("innerRadius",0),k=b+(u-b)*l,A=s.get("startAngle",0)+s.get("arc",0)*o;a.setAll({x:k*T.mC(A),y:k*T.O$(A)})}}}}}}Object.defineProperty(we,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordNodes"}),Object.defineProperty(we,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:se.classNames.concat([we.className])});var ut=Y(314);class oe extends ut.T{constructor(){super(...arguments),Object.defineProperty(this,"series",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fillGradient",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_strokeGradient",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_changed(){if(super._changed(),this.isDirty("fillStyle")){const t=this.series,e=this.dataItem;t&&e&&t._updateLinkColor(e)}}_getTooltipPoint(){let t=this.get("tooltipY"),e=.5;return t instanceof K.gG&&(e=t.value),this.getPoint(e)}}Object.defineProperty(oe,"className",{enumerable:!0,configurable:!0,writable:!0,value:"FlowLink"}),Object.defineProperty(oe,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ut.T.classNames.concat([oe.className])});class he extends oe{constructor(){super(...arguments),Object.defineProperty(this,"_p0",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_p1",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getPoint(t){if(this._p0&&this._p1){if("line"===this._type){let e=T.Zb(this._p0,this._p1,t);return{x:e.x,y:e.y,angle:T._O(this._p0,this._p1)}}{let e=T.YH(this._p0,this._p1,{x:0,y:0},Math.max(0,t-.01)),i=T.YH(this._p0,this._p1,{x:0,y:0},Math.min(1,t+.01)),a=T.YH(this._p0,this._p1,{x:0,y:0},t);return{x:a.x,y:a.y,angle:T._O(e,i)}}}return{x:0,y:0,angle:0}}}Object.defineProperty(he,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordLink"}),Object.defineProperty(he,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:oe.classNames.concat([he.className])});var ae=Y(7166);class le extends ne{constructor(){super(...arguments),Object.defineProperty(this,"links",{enumerable:!0,configurable:!0,writable:!0,value:new re.o(ie.YS.new({}),()=>he._new(this._root,{themeTags:["link","shape"]},[this.links.template]))}),Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(we.new(this._root,{}))}),Object.defineProperty(this,"_d3chord",{enumerable:!0,configurable:!0,writable:!0,value:Ye(!1,!1)}),Object.defineProperty(this,"_chordLayout",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_ribbon",{enumerable:!0,configurable:!0,writable:!0,value:tt()})}_afterNew(){this._settings.themeTags=ae.Fy(this._settings.themeTags,["chord"]),this.linksContainer.setAll({x:K.CI,y:K.CI}),this.bulletsContainer.setAll({x:K.CI,y:K.CI}),super._afterNew()}_fixRibbon(t){t.startAngle(e=>e.startAngle+this.get("startAngle",0)*T.sE+Math.PI/2),t.endAngle(e=>e.endAngle+this.get("startAngle",0)*T.sE+Math.PI/2)}makeLink(t){const e=this.linksContainer.children.push(this.links.make());return this.links.push(e),e._setDataItem(t),e.set("source",t.get("source")),e.set("target",t.get("target")),e.series=this,e}_makeMatrix(){const t=[];return V.S6(this.nodes.dataItems,e=>{const i=[];t.push(i);let a=e.get("outgoingLinks");V.S6(this.nodes.dataItems,s=>{let o=0;a&&V.S6(a,l=>{l.get("target")===s&&(o=l.get("valueWorking"));let u=this.getPrivate("valueSum",0),b=this.get("minSize",0);o>0&&b>0&&o<u*b&&(o=u*b)}),i.push(o)})}),t}_prepareChildren(){super._prepareChildren(),this._fixRibbon(this._ribbon);let t=!1;if(this._valuesDirty||this._sizeDirty||this.isDirty("padAngle")||this.isDirty("startAngle")){const e=this._makeMatrix();this._d3chord.padAngle(this.get("padAngle",0)*T.sE);const i=this.get("sort");"ascending"===i?this._d3chord.sortGroups(Gt):"descending"===i&&this._d3chord.sortGroups(It),this._chordLayout=this._d3chord(e),t=!0}if(t||this.isDirty("radius")||this.isDirty("nodeWidth")){let e=ae.Iy(this.get("radius",0),Math.min(this.innerWidth(),this.innerHeight()))/2,i=0;const a=this.get("startAngle",0),s=this.get("nodeWidth",0);V.S6(this.nodes.dataItems,l=>{const u=l.get("slice"),b=this._chordLayout.groups[i],k=b.startAngle*T.v4+a,A=b.endAngle*T.v4+a;u.setAll({radius:e,innerRadius:e-s,startAngle:k,arc:A-k});const S=l.get("label");S.setAll({labelAngle:k+(A-k)/2}),S.setPrivate("radius",e),S.setPrivate("innerRadius",.1),i++});const o=e-this.get("nodeWidth",0);V.S6(this._chordLayout,l=>{let u=this._linksByIndex[l.source.index+"_"+l.target.index];if(u||(u=this._linksByIndex[l.target.index+"_"+l.source.index]),u){const b=u.get("link");this._getLinkPoints(b,o,l),this._updateLink(this._ribbon,b,o,l)}})}}_getLinkPoints(t,e,i){const a=i.source,s=i.target,o=this.get("startAngle",0)*T.sE;if(a&&s){const l=a.startAngle,b=l+(a.endAngle-l)/2+o,k=s.startAngle,S=k+(s.endAngle-k)/2+o;t._p0={x:e*Math.cos(b),y:e*Math.sin(b)},t._p1={x:e*Math.cos(S),y:e*Math.sin(S)}}}_updateLink(t,e,i,a){a&&(t.sourceRadius(ae.Iy(e.get("sourceRadius",K.AQ),i)),t.targetRadius(ae.Iy(e.get("targetRadius",K.AQ),i)),e.set("draw",s=>{t.context(s),t(a)}))}disposeDataItem(t){super.disposeDataItem(t);let e=t.get("label");e&&e.dispose()}}Object.defineProperty(le,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Chord"}),Object.defineProperty(le,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ne.classNames.concat([le.className])});class xe extends he{_afterNew(){this._settings.themeTags=ae.Fy(this._settings.themeTags,["chord","link","directed"]),super._afterNew()}}Object.defineProperty(xe,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordLinkDirected"}),Object.defineProperty(xe,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:he.classNames.concat([xe.className])});class Ce extends le{constructor(){super(...arguments),Object.defineProperty(this,"_d3chord",{enumerable:!0,configurable:!0,writable:!0,value:Ye(!0,!1)}),Object.defineProperty(this,"_ribbonArrow",{enumerable:!0,configurable:!0,writable:!0,value:nt()}),Object.defineProperty(this,"links",{enumerable:!0,configurable:!0,writable:!0,value:new re.o(ie.YS.new({}),()=>xe._new(this._root,{themeTags:["link","shape"]},[this.links.template]))})}makeLink(t){const e=this.linksContainer.children.push(this.links.make());return e._setDataItem(t),e.set("source",t.get("source")),e.set("target",t.get("target")),e.series=this,e}_afterNew(){this._settings.themeTags=ae.Fy(this._settings.themeTags,["directed"]),super._afterNew(),this._markDirtyKey("linkHeadRadius")}_prepareChildren(){const t="linkHeadRadius";if(this.isDirty(t)){const e=this.get(t);if(null==e)this._ribbon=tt();else{let i=nt();i.headRadius(e),this._ribbon=i}}super._prepareChildren()}}Object.defineProperty(Ce,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordDirected"}),Object.defineProperty(Ce,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:le.classNames.concat([Ce.className])});class je extends le{_afterNew(){this._settings.themeTags=ae.Fy(this._settings.themeTags,["chord","basic"]),super._afterNew()}_makeMatrix(){const t=[];return V.S6(this.nodes.dataItems,e=>{const i=[];t.push(i),V.S6(this.nodes.dataItems,a=>{let s=1;e===a&&(s=0),i.push(s)})}),t}_updateLink(t,e,i,a){if(e._type=this.get("linkType"),a){const s=this.get("linkType");e.set("draw",o=>{let l=e._p0,u=e._p1;l&&u&&(o.moveTo(l.x,l.y),"line"==s?o.lineTo(u.x,u.y):o.quadraticCurveTo(0,0,u.x,u.y))})}}_getLinkPoints(t,e,i){const a=t.get("source"),s=t.get("target");if(a&&s){const o=a.get("slice"),l=s.get("slice"),k=o.get("startAngle",0)+o.get("arc",0)/2,N=l.get("startAngle",0)+l.get("arc",0)/2;t._p0={x:e*T.mC(k),y:e*T.O$(k)},t._p1={x:e*T.mC(N),y:e*T.O$(N)}}}}Object.defineProperty(je,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordNonRibbon"}),Object.defineProperty(je,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:le.classNames.concat([je.className])});var tn=Y(1519);class _e extends se{constructor(){super(...arguments),Object.defineProperty(this,"rectangles",{enumerable:!0,configurable:!0,writable:!0,value:new re.o(ie.YS.new({}),()=>tn.c._new(this._root,{themeTags:["shape"]},[this.rectangles.template]))}),Object.defineProperty(this,"flow",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}makeNode(t){const e=this.flow,i=super.makeNode(t,"sankey"),a=i.children.insertIndex(0,this.rectangles.make());this.rectangles.push(a),a._setSoft("fill",t.get("fill")),t.set("rectangle",a),i.events.on("dragged",()=>{const o=i.dataItem.get("d3SankeyNode");o&&e&&("horizontal"==e.get("orientation")?(o.x0=i.x(),o.y0=i.y()):(o.x0=i.y(),o.y0=i.x()),e.updateSankey())});const s=this.labels.make();return this.labels.push(s),e&&s.addTag(e.get("orientation","")),i.children.push(s),t.set("label",s),s._setDataItem(t),a._setDataItem(t),i}_positionBullet(t){const e=t.get("sprite");if(e){const i=e.dataItem;if(i){const a=t.get("sprite");if(a){const s=i.get("rectangle"),o=i.get("node"),l=t.get("locationX",.5),u=t.get("locationY",.5);s&&a.setAll({x:o.x()+s.width()*l,y:o.y()+s.height()*u})}}}}disposeDataItem(t){super.disposeDataItem(t);let e=t.get("rectangle");e&&(this.rectangles.removeValue(e),e.dispose())}}Object.defineProperty(_e,"className",{enumerable:!0,configurable:!0,writable:!0,value:"SankeyNodes"}),Object.defineProperty(_e,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:se.classNames.concat([_e.className])});class Ae extends oe{constructor(){super(...arguments),Object.defineProperty(this,"_svgPath",{enumerable:!0,configurable:!0,writable:!0,value:document.createElementNS("http://www.w3.org/2000/svg","path")}),Object.defineProperty(this,"_totalLength",{enumerable:!0,configurable:!0,writable:!0,value:0})}_beforeChanged(){if(super._beforeChanged(),this.isDirty("source")){const s=this.get("source");if(s){const o=s.get("node");this._disposers.push(o.events.on("positionchanged",()=>{this.markDirty()}))}}if(this.isDirty("target")){const s=this.get("target");if(s){const o=s.get("node");this._disposers.push(o.events.on("positionchanged",()=>{this.markDirty()}))}}if(this.isPrivateDirty("orientation")){const s=this.series,o=this.dataItem;o&&s&&s._updateLinkColor(o)}const t=this.get("target"),e=this.get("source");let i,a;if(e&&t){this._clear=!0,i=e.get("node"),a=t.get("node");let s=0,o=0,l=0,u=0,b=0,k=0,A=0,S=0,N=0,L=0,P=0,f=0,p=0,_=0,m=0,w=0,O=0,j=0;const H=this.dataItem;if(H){const I=H.get("d3SankeyLink");if(I){let R=I.width||0,F=this.getPrivate("orientation");"vertical"==F?(i&&(l=i.y()),a&&(u=a.y()),O=90,j=90,s=I.y0||0,o=I.y1||0,u<l&&([s,o]=[o,s],[l,u]=[u,l]),e.get("unknown")&&(s=o,l+=(u-l)/2),t.get("unknown")&&(o=s,u=l+(u-l)/2),b=s-R/2,k=l,A=o-R/2,S=u,N=s+R/2,L=o+R/2,P=l,f=u,p=s,_=o,m=l,w=u):(i&&(s=i.x()),a&&(o=a.x()),l=I.y0||0,u=I.y1||0,o<s&&([s,o]=[o,s],[l,u]=[u,l]),e.get("unknown")&&(l=u,s+=(o-s)/2),t.get("unknown")&&(u=l,o=s+(o-s)/2),b=s,k=l-R/2,A=o,S=u-R/2,N=s,L=o,P=l+R/2,f=u+R/2,p=s,_=o,m=l,w=u),T.NM(b,3)==T.NM(A,3)&&(A+=.01),T.NM(k,3)==T.NM(S,3)&&(S+=.01),T.NM(N,3)==T.NM(L,3)&&(L+=.01),T.NM(P,3)==T.NM(f,3)&&(f+=.01);let z=this.get("controlPointDistance",.2);z=Math.min(.4999,z);let Q=b+(A-b)*z*T.mC(O),E=k+(S-k)*z*T.O$(O),h=A-(A-b)*z*T.mC(j),r=S-(S-k)*z*T.O$(j),c=p+(_-p)*z*T.mC(O),g=m+(w-m)*z*T.O$(O),y=_-(_-p)*z*T.mC(j),d=w-(w-m)*z*T.O$(j),v=T._O({x:Q,y:E},{x:h,y:r}),x=(R/T.mC(v)-R)/T.OR(v)*T.mC(O),D=(R/T.O$(v)-R)*T.OR(v)*T.O$(O),B=-x/2+N+(L-N)*z*T.mC(O),G=-D/2+P+(f-P)*z*T.O$(O),W=-x/2+L-(L-N)*z*T.mC(j),X=-D/2+f-(f-P)*z*T.O$(j);Q+=x/2,E+=D/2,h+=x/2,r+=D/2,"vertical"==F?(E=Math.min(S,Math.max(k+1,E)),G=Math.min(f,Math.max(P+1,G)),r=Math.max(k,Math.min(S-1,r)),X=Math.max(P,Math.min(f-1,X))):(Q=Math.min(A,Math.max(b+1,Q)),B=Math.min(L,Math.max(N+1,B)),h=Math.max(b,Math.min(A-1,h)),W=Math.max(N,Math.min(L-1,W)));let M=[[b,k,N,P],[Q,E,B,G],[h,r,W,X],[A,S,L,f]];this.set("draw",fe=>{const Le=this.series;Le._fillGenerator.context(fe),Le._fillGenerator(M)});const ee=this.series._strokeGenerator([[p,m],[c,g],[y,d],[_,w]]);ee&&(this._svgPath.setAttribute("d",ee),this._totalLength=this._svgPath.getTotalLength())}}}this.series&&this.dataItem&&this.series._positionBullets(this.dataItem)}getPoint(t){if(this._svgPath&&this._svgPath.getAttribute("d")){let e=this._svgPath.getPointAtLength(t*this._totalLength-.1),i=this._svgPath.getPointAtLength(t*this._totalLength+.1),a=this.toGlobal(this._svgPath.getPointAtLength(t*this._totalLength));return{x:a.x,y:a.y,angle:T._O(e,i)}}return{x:0,y:0,angle:0}}_getTooltipPoint(){return this.toLocal(super._getTooltipPoint())}}Object.defineProperty(Ae,"className",{enumerable:!0,configurable:!0,writable:!0,value:"SankeyLink"}),Object.defineProperty(Ae,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:oe.classNames.concat([Ae.className])});var nn=Y(6675),rn=Y(6069),ct=Y(9820),ht=Y(4549);function He(n,t){let e=0;if(void 0===t)for(let i of n)(i=+i)&&(e+=i);else{let i=-1;for(let a of n)(a=+t(a,++i,n))&&(e+=a)}return e}function ft(n,t){let e;if(void 0===t)for(const i of n)null!=i&&(e<i||void 0===e&&i>=i)&&(e=i);else{let i=-1;for(let a of n)null!=(a=t(a,++i,n))&&(e<a||void 0===e&&a>=a)&&(e=a)}return e}function gt(n,t){let e;if(void 0===t)for(const i of n)null!=i&&(e>i||void 0===e&&i>=i)&&(e=i);else{let i=-1;for(let a of n)null!=(a=t(a,++i,n))&&(e>a||void 0===e&&a>=a)&&(e=a)}return e}function sn(n){return n.target.depth}function on(n){return n.depth}function an(n,t){return t-1-n.height}function dt(n,t){return n.sourceLinks.length?n.depth:t-1}function ln(n){return n.targetLinks.length?n.depth:n.sourceLinks.length?gt(n.sourceLinks,sn)-1:0}function ze(n){return function(){return n}}function pt(n,t){return Me(n.source,t.source)||n.index-t.index}function mt(n,t){return Me(n.target,t.target)||n.index-t.index}function Me(n,t){return n.y0-t.y0}function $e(n){return n.value}function un(n){return n.index}function cn(n){return n.nodes}function hn(n){return n.links}function yt(n,t){const e=n.get(t);if(!e)throw new Error("missing: "+t);return e}function bt({nodes:n}){for(const t of n){let e=t.y0,i=e;for(const a of t.sourceLinks)a.y0=e+a.width/2,e+=a.width;for(const a of t.targetLinks)a.y1=i+a.width/2,i+=a.width}}function fn(){let o,b,k,n=0,t=0,e=1,i=1,a=24,s=8,l=un,u=dt,A=cn,S=hn,N=6;function L(){const r={nodes:A.apply(null,arguments),links:S.apply(null,arguments)};return function P({nodes:r,links:c}){for(const[y,d]of r.entries())d.index=y,d.sourceLinks=[],d.targetLinks=[];const g=new Map(r.map((y,d)=>[l(y,d,r),y]));for(const[y,d]of c.entries()){d.index=y;let{source:v,target:x}=d;"object"!=typeof v&&(v=d.source=yt(g,v)),"object"!=typeof x&&(x=d.target=yt(g,x)),v.sourceLinks.push(d),x.targetLinks.push(d)}if(null!=k)for(const{sourceLinks:y,targetLinks:d}of r)y.sort(k),d.sort(k)}(r),function f({nodes:r}){for(const c of r)c.value=void 0===c.fixedValue?Math.max(He(c.sourceLinks,$e),He(c.targetLinks,$e)):c.fixedValue}(r),function p({nodes:r}){const c=r.length;let g=new Set(r),y=new Set,d=0;for(;g.size;){for(const v of g){v.depth=d;for(const{target:x}of v.sourceLinks)y.add(x)}if(++d>c)throw new Error("circular link");g=y,y=new Set}}(r),function _({nodes:r}){const c=r.length;let g=new Set(r),y=new Set,d=0;for(;g.size;){for(const v of g){v.height=d;for(const{source:x}of v.targetLinks)y.add(x)}if(++d>c)throw new Error("circular link");g=y,y=new Set}}(r),function O(r){const c=function m({nodes:r}){const c=ft(r,d=>d.depth)+1,g=(e-n-a)/(c-1),y=new Array(c);for(const d of r){const v=Math.max(0,Math.min(c-1,Math.floor(u.call(null,d,c))));d.layer=v,d.x0=n+v*g,d.x1=d.x0+a,y[v]?y[v].push(d):y[v]=[d]}if(b)for(const d of y)d.sort(b);return y}(r);o=Math.min(s,(i-t)/(ft(c,g=>g.length)-1)),function w(r){const c=gt(r,g=>(i-t-(g.length-1)*o)/He(g,$e));for(const g of r){let y=t;for(const d of g){d.y0=y,d.y1=y+d.value*c,y=d.y1+o;for(const v of d.sourceLinks)v.width=v.value*c}y=(i-y+o)/(g.length+1);for(let d=0;d<g.length;++d){const v=g[d];v.y0+=y*(d+1),v.y1+=y*(d+1)}Q(g)}}(c);for(let g=0;g<N;++g){const y=Math.pow(.99,g),d=Math.max(1-y,(g+1)/N);H(c,y,d),j(c,y,d)}}(r),bt(r),r}function j(r,c,g){for(let y=1,d=r.length;y<d;++y){const v=r[y];for(const x of v){let D=0,B=0;for(const{source:W,value:X}of x.targetLinks){let M=X*(x.layer-W.layer);D+=E(W,x)*M,B+=M}if(!(B>0))continue;let G=(D/B-x.y0)*c;x.y0+=G,x.y1+=G,z(x)}void 0===b&&v.sort(Me),I(v,g)}}function H(r,c,g){for(let d=r.length-2;d>=0;--d){const v=r[d];for(const x of v){let D=0,B=0;for(const{target:W,value:X}of x.sourceLinks){let M=X*(W.layer-x.layer);D+=h(x,W)*M,B+=M}if(!(B>0))continue;let G=(D/B-x.y0)*c;x.y0+=G,x.y1+=G,z(x)}void 0===b&&v.sort(Me),I(v,g)}}function I(r,c){const g=r.length>>1,y=r[g];F(r,y.y0-o,g-1,c),R(r,y.y1+o,g+1,c),F(r,i,r.length-1,c),R(r,t,0,c)}function R(r,c,g,y){for(;g<r.length;++g){const d=r[g],v=(c-d.y0)*y;v>1e-6&&(d.y0+=v,d.y1+=v),c=d.y1+o}}function F(r,c,g,y){for(;g>=0;--g){const d=r[g],v=(d.y1-c)*y;v>1e-6&&(d.y0-=v,d.y1-=v),c=d.y0-o}}function z({sourceLinks:r,targetLinks:c}){if(void 0===k){for(const{source:{sourceLinks:g}}of c)g.sort(mt);for(const{target:{targetLinks:g}}of r)g.sort(pt)}}function Q(r){if(void 0===k)for(const{sourceLinks:c,targetLinks:g}of r)c.sort(mt),g.sort(pt)}function E(r,c){let g=r.y0-(r.sourceLinks.length-1)*o/2;for(const{target:y,width:d}of r.sourceLinks){if(y===c)break;g+=d+o}for(const{source:y,width:d}of c.targetLinks){if(y===r)break;g-=d}return g}function h(r,c){let g=c.y0-(c.targetLinks.length-1)*o/2;for(const{source:y,width:d}of c.targetLinks){if(y===r)break;g+=d+o}for(const{target:y,width:d}of r.sourceLinks){if(y===c)break;g-=d}return g}return L.update=function(r){return bt(r),r},L.nodeId=function(r){return arguments.length?(l="function"==typeof r?r:ze(r),L):l},L.nodeAlign=function(r){return arguments.length?(u="function"==typeof r?r:ze(r),L):u},L.nodeSort=function(r){return arguments.length?(b=r,L):b},L.nodeWidth=function(r){return arguments.length?(a=+r,L):a},L.nodePadding=function(r){return arguments.length?(s=o=+r,L):s},L.nodes=function(r){return arguments.length?(A="function"==typeof r?r:ze(r),L):A},L.links=function(r){return arguments.length?(S="function"==typeof r?r:ze(r),L):S},L.linkSort=function(r){return arguments.length?(k=r,L):k},L.size=function(r){return arguments.length?(n=t=0,e=+r[0],i=+r[1],L):[e-n,i-t]},L.extent=function(r){return arguments.length?(n=+r[0][0],e=+r[1][0],t=+r[0][1],i=+r[1][1],L):[[n,t],[e,i]]},L.iterations=function(r){return arguments.length?(N=+r,L):N},L}class Ge extends ne{constructor(){super(...arguments),Object.defineProperty(this,"links",{enumerable:!0,configurable:!0,writable:!0,value:new re.o(ie.YS.new({}),()=>Ae._new(this._root,{themeTags:["link","shape"]},[this.links.template]))}),Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(_e.new(this._root,{}))}),Object.defineProperty(this,"_d3Sankey",{enumerable:!0,configurable:!0,writable:!0,value:fn()}),Object.defineProperty(this,"_d3Graph",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fillGenerator",{enumerable:!0,configurable:!0,writable:!0,value:(0,nn.Z)()}),Object.defineProperty(this,"_strokeGenerator",{enumerable:!0,configurable:!0,writable:!0,value:(0,rn.Z)()})}_afterNew(){this._settings.themeTags=ae.Fy(this._settings.themeTags,["sankey",this._settings.orientation||"horizontal"]),this._fillGenerator.y0(function(t){return t[3]}),this._fillGenerator.x0(function(t){return t[2]}),this._fillGenerator.y1(function(t){return t[1]}),this._fillGenerator.x1(function(t){return t[0]}),super._afterNew()}makeLink(t){const e=t.get("source"),i=t.get("target"),a=this.links.make();return e.get("unknown")&&(a.addTag("source"),a.addTag("unknown")),i.get("unknown")&&(a.addTag("target"),a.addTag("unknown")),this.linksContainer.children.push(a),a._setDataItem(t),a.set("source",e),a.set("target",i),a.series=this,this.links.push(a),a}updateSankey(){const t=this._d3Graph;t&&(this._d3Sankey.update(t),V.S6(this.dataItems,e=>{const i=e.get("link");i.setPrivate("orientation",this.get("orientation")),i.markDirty()}))}_updateLinkColor(t){super._updateLinkColor(t);const e=this.get("orientation"),i=t.get("link")._fillGradient,a=t.get("link")._strokeGradient;"vertical"==e?(i&&i.set("rotation",90),a&&a.set("rotation",90)):(i&&i.set("rotation",0),a&&a.set("rotation",0))}_getBulletLocation(t){return"vertical"==this.get("orientation")?t.get("locationY",0):t.get("locationX",0)}_prepareChildren(){super._prepareChildren();let t=!1;if("vertical"==this.get("orientation")&&(t=!0),this.isDirty("orientation")||this.isDirty("linkTension")){const e=this.get("linkTension",.5);t?(this._fillGenerator.curve((0,ht.$)(e)),this._strokeGenerator.curve((0,ht.$)(e))):(this._fillGenerator.curve((0,ct.G)(e)),this._strokeGenerator.curve((0,ct.G)(e)))}if((this._valuesDirty||this._sizeDirty||this.isDirty("nodePadding")||this.isDirty("nodeWidth")||this.isDirty("nodeAlign")||this.isDirty("nodeSort")||this.isDirty("orientation")||this.isDirty("linkTension"))&&this._nodesData.length>0){const e=this._d3Sankey;let i=this.innerWidth(),a=this.innerHeight();switch(t&&([i,a]=[a,i]),e.size([i,a]),e.nodePadding(this.get("nodePadding",10)),e.nodeWidth(this.get("nodeWidth",10)),e.nodeSort(this.get("nodeSort",null)),this.get("nodeAlign")){case"right":e.nodeAlign(an);break;case"justify":e.nodeAlign(dt);break;case"center":e.nodeAlign(ln);break;default:e.nodeAlign(on)}this._d3Graph=e({nodes:this._nodesData,links:this._linksData}),V.S6(this.dataItems,o=>{const l=o.get("link");l.setPrivate("orientation",this.get("orientation")),l.markDirty()});const s=this._d3Graph;s&&V.S6(s.nodes,l=>{const u=l.dataItem,b=u.get("node");let k,A,S,N;t?(k=l.y0,A=l.y1,S=l.x0,N=l.x1):(k=l.x0,A=l.x1,S=l.y0,N=l.y1),te.hj(k)&&te.hj(A)&&te.hj(S)&&te.hj(N)&&(b.setAll({x:k,y:S,width:A-k,height:N-S}),u.get("rectangle").setAll({width:A-k,height:N-S}))})}}}Object.defineProperty(Ge,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Sankey"}),Object.defineProperty(Ge,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ne.classNames.concat([Ge.className])})}}]);